<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="LG Electronics America R&D Center">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Controllable Plugins - LGSVL Simulator</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Controllable Plugins";
    var mkdocs_page_input_path = "controllable-plugins.md";
    var mkdocs_page_url = "/controllable-plugins/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-130546445-1', 'lgsvlsimulator.com/docs');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <!-- edit link, open in new tab -->
        <a href="https://www.lgsvlsimulator.com" class="icon icon-home" target="_blank_"> LGSVL Simulator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Quick start</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../getting-started/">Getting started</a>
                </li>
                <li class="">
                    
    <a class="" href="../keyboard-shortcuts/">Keyboard shortcuts</a>
                </li>
                <li class="">
                    
    <a class="" href="../changelog/">Release notes</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Web User Interface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../maps-tab/">Maps</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vehicles-tab/">Vehicles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../sensor-json-options/">Sensor Parameters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../clusters-tab/">Clusters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../simulations-tab/">Simulations</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Simulation User Interface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../simulation-menu/">Menu Items</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../sensor-visualizers/">Sensor Visualization</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../bridge-connection-ui/">Bridge Topics</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../config-and-cmd-line-params/">Configuration File and Command Line Parameters</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Integration with AD</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Running with Autoware.AI</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../autoware-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../autoware-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Running with Autoware.Auto</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../autoware-auto-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../autoware-auto-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Running with Apollo 5.0</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../apollo5-0-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../apollo5-0-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Running with Apollo 3.0</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../apollo-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../apollo-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Ground truth obstacles</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../perception-ground-truth/">Viewing and subscribing to ground truth data</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../ground-truth-json-example/">Sample sensor configuration for data collection</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Python API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../python-api/">Python API Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-quickstart-descriptions/">Python API Quickstart Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-example-descriptions/">Python API Use Case Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-how-to-run-scenario/">How to Run a Scenario</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../openai-gym/">Reinforcement Learning with OpenAI Gym</a>
                </li>
                <li class="">
                    
    <a class="" href="../lane-following/">Deep Learning Lane Following Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../create-ros2-ad-stack/">How to create a simple ROS2-based AD stack</a>
                </li>
                <li class="">
                    
    <a class="" href="../control-calibration/">How to Collect Data with Control Calibration Sensor</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Advanced</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../map-annotation/">Map Annotation</a>
                </li>
                <li class="">
                    
    <a class="" href="../build-instructions/">Build instructions</a>
                </li>
                <li class="">
                    
    <a class="" href="../assets/">Adding Assets</a>
                </li>
                <li class="">
                    
    <a class="" href="../add-new-ego-vehicle/">How to add a new ego vehicle</a>
                </li>
                <li class="">
                    
    <a class="" href="../npc-map-navigation/">NPC Map Navigation</a>
                </li>
                <li class="">
                    
    <a class="" href="../sensor-plugins/">Sensor Plugins</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Controllable Plugins</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#building-controllable-plugins">Building Controllable Plugins</a></li>
    

    <li class="toctree-l3"><a href="#creating-controllable-plugins">Creating Controllable Plugins</a></li>
    

    <li class="toctree-l3"><a href="#controllable-logic">Controllable Logic</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Support</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../faq/">FAQ</a>
                </li>
                <li class="">
                    
    <a class="" href="../contributing/">Contributing</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">LGSVL Simulator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Advanced &raquo;</li>
        
      
    
    <li>Controllable Plugins</li>
    <li class="wy-breadcrumbs-aside">
      
      <!-- edited to not display Github edit link -->
        <a style="display:none;" href="https://github.com/lgsvl/simulator/edit/master/Docs/controllable-plugins.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1>Controllable Plugins <a href="#top"></a></h1>
<p>Controllable plugins are custom controllables that can be added to a scene at runtime with the API. Before running the simulator (running the executable or pressing <code>Play</code> in the Editor) controllable plugins must be built by the simulator using <code>Simulator -&gt; Build...</code> menu and the built asset placed in the <code>AssetBundles/Controllables</code> folder.</p>
<p>Open-source example:</p>
<ul>
<li><a href="https://github.com/lgsvl/TrafficCone">TrafficCone</a></li>
</ul>
<h2> Table of Contents</h2>

<div class="toc">
<ul>
<li><a href="#building-controllable-plugins">Building Controllable Plugins</a></li>
<li><a href="#creating-controllable-plugins">Creating Controllable Plugins</a></li>
<li><a href="#controllable-logic">Controllable Logic</a></li>
</ul>
</div>
<h2 id="building-controllable-plugins">Building Controllable Plugins <a class="wikilink" href="#top">top</a><a class="headerlink" href="#building-controllable-plugins" title="Permanent link">#</a></h2>
<ol>
<li>Open <code>Simulator -&gt; Build...</code> menu item   </li>
<li>Select controllable plugins in "Controllables" section of build window   </li>
<li>Build plugins with "Build" button</li>
</ol>
<p><a href="../images/full_size_images/controllables-build.png"><img alt="" src="../images/controllables-build.png" /></a></p>
<p>The bundle named <code>controllable_XXX</code> will be placed in the <code>AssetBundles/Controllables</code> folder. If building the binary, this folder is included in the target destination.</p>
<p>See <a href="build-instructions">build instructions</a> for more details.</p>
<h2 id="creating-controllable-plugins">Creating Controllable Plugins <a class="wikilink" href="#top">top</a><a class="headerlink" href="#creating-controllable-plugins" title="Permanent link">#</a></h2>
<p>Create a folder in <code>Assets/External/Controllables</code> , e.g. Assets/External/Controllables/TrafficCone.</p>
<p>Inside this folder you must place the controllable prefab with same name (<code>TrafficCone.prefab</code>) that will be used by simulator to instantiate at runtime, the controllable logic script and Models folder with materials and textures. </p>
<p><a href="../images/full_size_images/controllables-folder-structure.png"><img alt="" src="../images/controllables-folder-structure.png" /></a></p>
<p>This prefab must have a logic script that inherits interface IControllable and added to the root of the prefab.    The controllable tag and layer for traffic cone is set to Obstacle.  If collisions are desired, then add a collider components.  A Rigidbody component can be added if velocity changes are desired, if not, velocity change commands will be ignored.</p>
<p><a href="../images/full_size_images/controllable-prefab-components.png"><img alt="" src="../images/controllable-prefab-components.png" /></a></p>
<p>To create a prefab:</p>
<ol>
<li>Right-click in the scene hierarchy and select <code>Create Empty</code></li>
<li>Change the name to the name of the controllable (e.g. <code>TrafficCone</code>)</li>
<li>In the Inspector for this object, select <code>Add Component</code></li>
<li>Search for the controllable script</li>
<li>Add Rigidbody if needed</li>
<li>Add Collider if needed</li>
<li>Drag this object from the scene hierarchy into the project folder to create a new prefab, delete prefab in Hierarchy panel</li>
</ol>
<p><a href="../images/full_size_images/controllable-create-prefab.png"><img alt="" src="../images/controllable-create-prefab.png" /></a></p>
<h2 id="controllable-logic">Controllable Logic <a class="wikilink" href="#top">top</a><a class="headerlink" href="#controllable-logic" title="Permanent link">#</a></h2>
<p>Additionally place a C# script which will be compiled &amp; bundled with prefab, as well as any additional Unity resources (shaders, materials, textures, etc...). <strong>This is required even for simple objects such as a Traffic Cone.</strong></p>
<p>Controllable scripts must inherit interface <code>IControllable</code> which allows controllables to receive API commands. In addition, it must implement all interface variables and methods.  See the below code block from TrafficCone.cs:</p>
<pre><code class="c#">namespace Simulator.Controllable
{
    public class TrafficCone : MonoBehaviour, IControllable,
    {
        public bool Spawned { get; set; }
        public string UID { get; set; }
        public string Key =&gt; UID;
        public string ControlType { get; set; } = &quot;cone&quot;;
        public string CurrentState { get; set; }
        public string[] ValidStates { get; set; } = new string[] { };
        public string[] ValidActions { get; set; } = new string[] { };
        public string DefaultControlPolicy { get; set; } = &quot;&quot;;
        public string CurrentControlPolicy { get; set; }

        private void Awake()
        {
            CurrentControlPolicy = DefaultControlPolicy;
            CurrentState = &quot;&quot;;
        }

        public void Control(List&lt;ControlAction&gt; controlActions)
        {
            for (int i = 0; i &lt; controlActions.Count; i++)
            {
                var action = controlActions[i].Action;
                var value = controlActions[i].Value;

                switch (action)
                {
                    case = &quot;state&quot;: // set in policy parse
                        CurrentState = value;
                        // switch (CurrentState)
                        //     set logic
                        break;
                    default:
                        Debug.LogError($&quot;'{action}' is an invalid action for '{ControlType}'&quot;);
                        break;
                }
            }
        }
    }
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../faq/" class="btn btn-neutral float-right" title="FAQ">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../sensor-plugins/" class="btn btn-neutral" title="Sensor Plugins"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2019 LG Electronics Inc.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/lgsvl/simulator/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../sensor-plugins/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../faq/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../javascripts/clipboard.js" defer></script>
      <script src="../javascripts/copy-to-clipboard.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
